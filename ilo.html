<html lang="en"><head>
		<title>ilo pona</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- import the webpage's stylesheet -->
		<link rel="stylesheet" href="./main.css" type="text/css">
		<!-- import the font -->
		<link rel="stylesheet" href="https://davidar.github.io/linja-pona/stylesheet.css">
		<style>
			tokipona {
				font-family: linja-pona, sans-serif; 
			}
		</style>

		<!-- <script src="./nimi pi toki pona.js"></script> -->
		
 </head>
	<body>
		<header>
			<h1>
				<tokipona>o sitelen e nimi sina</tokipona>
				<english>Type toki pona words</english>
			</h1>
		</header>

		<main>
			<tokipona contenteditable="true" id="main">
				lupa wile lupa
			</tokipona>	


			<input type="checkbox" checked onchange="togglefont(event)"> 
			<tokipona>kepeken <span class="toggledtext" hidden>ala</span> e sitelen pona</tokipona> <english><span class="toggledtext" hidden>not</span> using font</english>
			<script>
				let sheet = document.createElement('style'); // has to be an internal style tag
				document.body.append(sheet);

				fonts = ["arial",'linja-pona'];

				function togglefont(e) {
					toggle = e.target.checked;
					[...document.getElementsByClassName("toggledtext")].forEach(element=>element.hidden = toggle);

					sheet.innerHTML = "tokipona {font-family: "+fonts[toggle*1]+";}" // *1 convertes false->0 true->1
				}
			</script>
		</main>

		<footer>
			<tokipona>jan [_<span id="name">LI_LE</span>] li mama e lipu ni</tokipona>
			<english>Made by jan Lile</english>
			<script> 
				randItem = array=> array[Math.floor(Math.random()*array.length)]
				document.getElementById('name').innerText = [["lili", "lape", "len", "lawa", "lipu", "lon"], ["ijo", "ilo", "ike", "insa"], ["la", "li", "linja", "lukin", "lon"], ["en", "e", "esun"]].map(randItem).join('_')
			</script>
		</footer>


		<script>
			// define dictionary (data kept slightly compacted array form to reduce page size)
			const initial = {"number":"#", "preposition":"prepo.", "condition":"condtn.", "interjection":"intj.", "modal":"modal", "noun": "noun", "conjunction":"particle", "modifier":"adj.", "intransitive verb":"v.i", "transitive verb":"v.t"}

			let mapping = 
			["text", "main","noun", "modifier", "transitive verb", "intransitive verb", "condition", "preposition", "conjunction", "modal", "interjection", "number"]

			var pu = [
				["a",		 8, ["exclamation", "moan", "groan", "cry"], [], ["utters in emotional manner", "with many 'ah's", "utters 'ah' to express"], ["exclaim", "moan", "...", "utters 'ah'"], [], [], [], [], ["ah!", "ow!", "oof!", "ugh!", "ah hah!", "ohoh!", "uhuh!", "oy vey!", "hahaha (a a a)", "stop! don't do that! (a a a a)"]], 
				["akesi",	 0, ["reptile", "amphibian", "toad", "lizard", "small ugly animal", "slimy animal"], [], ["turn into a reptile", "puke a reptile/amphibian onto", "make ugly"], ["be an reptile/amphibian"]], 
				["ala",		 1, ["nothing", "void", "vacuum"], ["not", "{negation}", "none of", "not any"], ["destroy", "annihilate"], ["be nothing"], [], [], [], [], ["no!"], ["0"]], 
				["alasa",	 2, ["hunting"], ["hunting (type of animal)", "game (type of animal)"], ["hunt", "forage", "gather", "harvest"], ["be hunting", "be game"]], 
				["ale",		 1, ["everything", "the world", "the universe", "life", "abundance"], ["all", "each", "any", "every", "all of", "the whole of", "complete abundant"], ["make one with everything", "complete"], ["be everything", "be complete"], [], [], [], [], [], ["100"]], 
				["ali",		 1, ["everything", "the world", "the universe", "life", "abundance"], ["all", "each", "any", "every", "all of", "the whole of", "complete abundant"], ["make one with everything", "complete"], ["be everything", "be complete"], [], [], [], [], [], ["100"]], 
				["anpa",	 0, ["underside", "basement", "lower levels", "bottom", "defeat", "fall", "descent", "bowing down", "humble", "lowly dependent"], ["below", "low", "underneath", "deep"], ["defeat", "enslave", "lower", "fell"], ["be below", "be defeated", "be subservient", "go down", "be underneath", "be underground", "be low", "be deep", "be subservient"]], 
				["ante",	 1, ["difference", "strangeness", "foreigner", "stranger"], ["different", "foreign", "strange (unfamiliar)", "altered"], ["change", "alter"], ["be different", "be foreign", "be a stranger"], ["otherwise", "on the other hand"]], 
				["anu",		 6, [], [], [], [], [], [], ["or", "which alternative"]], 
				["awen",	 7, ["inertia", "continuity", "continuum", "canned goods", "preserves", "stay", "wait"], ["continuing", "continuous", "perpetual", "steady", "patient", "permanent", "preserved", "saved", "reliable"], ["keep", "preserve", "anchor", "stabilise", "wait for"], ["continue", "be patient", "wait", "be permenant", "be reliable"], [], [], [], ["continue", "keep on"]], 
				["e",		 6, [], [], [], [], [], [], ["{marks beginning of direct object}", "{introduces new direct object}"]], 
				["en",		 6, ["addition"], [], [], [], [], [], ["and"]], 
				["esun",	 0, ["trade", "goods swap", "market", "shop", "store", "mall", "business"], ["marketable", "do business", "shop", "trade", "business"], ["buy", "sell"], ["be marketable", "be traded", "shop", "be a market", "be doing business"]], 
				["ijo",		 0, ["thing", "something", "anything", "physical object", "topic", "phenomenon", "matter", "about"], [], ["objectify"]], 
				["ike",		 1, ["evil", "badness", "complexity"], ["bad", "nonessential", "irrelevant"], ["make bad", "make complex", "spoil"], ["be bad", "be evil", "be complex"], ["unfortunately"], [], [], [], ["too bad!", "sorry!", "bummer!", "bad!"]], 
				["ilo",		 0, ["tool", "machine", "electronic device"], [], ["use"], ["be a tool", "be useful"]], 
				["insa",	 0, ["insides", "guts", "stomach", "heart", "center", "middle", "interior world", "inner life", "content"], ["visceral", "central", "interior"], ["ingest", "swallow", "absorb", "incorporate"], ["be central", "be interior", "be visceral"]], 
				["jaki",	 1, ["dirt", "garbage", "pollution", "pornography", "debauchery", "obscenity"], ["dirty", "impure", "polluted", "vile", "disgusting", "filthy", "tabu", "obscene", "sordid", "lurid"], ["dirty", "pollute"], ["be dirty", "be garbage", "be impure", "be polluted", "be disgusting"], [], [], [], [], ["ew!", "{cuss of disturbance}", "yucky!", "gross!"]], 
				["jan",		 0, ["human being", "person", "great ape", "member", "inhabitant", "someone", "anyone"], ["human", "personal", "someone's", "anyone's"], ["humanise", "personalise", "personify"], ["be human", "be a person", "be someone", "be a member"]], 
				["jelo",	 1, ["yellow"], ["yellow", "lime (colour)", "light brown"], ["color yellow"], ["be yellow"]], 
				["jo",		 2, ["possession", "ownership", "property", "contents"], ["owned", "private", "owner", "owner's"], ["have", "contain", "bear", "possess"], ["be owned", "be possessed"]], 
				["kala",	 0, ["fish", "sea animal", "animal that lives in water"], ["fishy"], [], ["be fishy", "be a sea animal"]], 
				["kalama",	 0, ["noise", "sound", "playing", "voice", "snore", "recite"], ["sonic", "noisy", "vocal"], ["make (sound)", "play (instrument)", "sound"], ["make noise", "be noisy", "be sonic", "be vocal"]], 
				["kama",	 7, ["future", "event", "occurrence", "arrival", "becoming", "beginning", "outcome"], ["come", "become", "happen", "future", "arriving", "initiating", "developing"], ["make happen", "summon", "bring", "fetch", "carry"], ["occur", "be arriving", "be in the future"], [], [], [], ["come", "future tense", "start", "manage to", "succeed in"]], 
				["kasi",	 0, ["plant", "herb", "tree", "bush", "vegetable", "leaf"], ["botanical", "vegetal", "herbal"], ["plant"], ["be a plant", "be botanical", "be vegetal", "be herbal"]], 
				["ken",		 7, ["ability", "rights", "permission", "power (status)"], ["able", "capable", "legal", "legitimate", "rightful", "permitted"], ["enable", "empower", "delegate to", "permit", "make possible"], ["be able to", "be allowed to", "be capable of", "be possible", "be legal", "be legitimate"], ["maybe", "possibly"], [], [], ["can", "no powerful force against", "may", "be able to", "allowed to", "free to", "possible"]], 
				["kepeken",	 5, ["use", "usage", "tool"], ["using", "useful", "handy"], ["use"], ["be useful", "be used"], [], ["using", "with"]], 
				["kili",	 0, ["fruit", "seeds", "mushrooms"], ["fruit", "fruity", "fruitful", "fertile"], ["pollinate", "ripen", "harvest"], ["bear fruit", "ripen", "be fruitful", "be fertile", "be fruit"]], 
				["kipisi",	 2, ["cut", "cutting", "portion", "fraction", "part"], ["partial", "incomplete", "divided", "cut"], ["cut"], ["cut"]], 
				["kiwen",	 1, ["stone", "rock", "mineral", "metal"], ["hard", "tough", "solid", "stone-like", "metallic", "mineral"], ["stone", "throw stones at", "solidify", "gel", "thicken"], ["be hard", "be metallic", "be mineral", "be solid"]], 
				["ko",		 0, ["goo", "paste", "powder", "gum", "gelatin", "dust", "dough", "clay", "semi-solid", "squishy thing"], ["soft", "squishy", "colloidal", "powdery"], ["pulverise", "grind", "reduce to a pasta", "glue", "affix with glue", "dust"], ["be soft", "be squishy", "be colloidial", "be powdery", "be goo"]], 
				["kon",		 0, ["air", "gas", "breath", "wind", "oder", "scent", "smell", "spirit", "soul", "essence", "unseen agent", "experiential life"], ["airy", "gaseous", "windy", "odoriferous", "ethereal", "spiritual", "soulful"], ["inflate", "breathe in", "gasify", "sublime", "vaporise", "boil"], ["breathe", "be airy", "be ethereal", "be spiritual"]], 
				["kule",	 0, ["colour", "tint", "paint", "shade"], ["colourful", "coloured", "painted"], ["colour", "color", "paint"], ["be colourful", "be coloured", "be painted"]], 
				["kulupu",	 0, ["group", "gathering", "community", "people", "society", "nation", "tribe", "clan", "set", "company", "meeting", "mob", "gang"], ["communal", "public", "national"], ["assemble", "call together", "form", "convene", "gang up on", "mob", "storm"], ["be communal", "be public", "be national", "be a group"]], 
				["kute",	 3, ["hearing", "listening", "gossip", "what heard", "ear"], ["auditory", "hearing", "listening"], ["hear", "listen to", "obey"], ["hear", "listening"], ["by hearsay"]], 
				["la",		 6, [], [], [], [], [], [], ["{marks end of condition}", "{marks end of temporal location/duration}", "at", "when", "{marks causal connection}", "if so then", "{marks end of emotions underlying utterance}", "{marks end of source of information}"]], 
				["lape",	 1, ["sleep", "unconsiousness", "rest"], ["asleep", "unconscious", "drugged", "resting"], [], ["put to sleep", "knock out"]], 
				["laso",	 1, ["blue", "aqua", "turqoise", "green"], ["blue", "blue-green", "turqoise", "green", "aqua", "cyan", "sea green"], ["color blue"]], 
				["lawa",	 0, ["head", "chief", "leader", "ruler", "mind", "law", "direction"], ["pertaining to head", "chief", "main", "mental", "legal", "lawful", "directive"], ["lead", "direct", "control", "guide", "rule", "steer", "show", "point", "enact", "decree", "legislate", "think about", "ponder"], ["lead", "rule"]], 
				["len",		 0, ["cloth", "fabric", "clothing", "privacy"], ["cloth", "dressed", "arrayed", "costumed", "dressed up"], ["wear", "be dressed in", "dress"], ["wear clothes"]], 
				["lete",	 1, ["cold", "north"], ["cold", "uncooked", "raw", "north"], ["cool", "chill", "freeze"], ["be cold"]], 
				["li",		 6, [], [], [], [], [], [], ["{marks end of subject}", "{marks beginning of new predicate}"]], 
				["lili",	 1, ["smallness", "youth", "immaturity", "a bit"], ["small", "short", "thin", "lightweight", "few", "narrow", "brief", "young", "immature"], ["lessen", "diminish", "shrink", "reduce"]], 
				["linja",	 0, ["string", "long thin floppy thing", "rope", "thread", "cord", "chain", "spaghetti", "hair", "connection", "relationship"], ["stringy", "hairy"], ["tie", "bind", "tie up", "connect"]], 
				["lipu",	 0, ["sheet", "flat bendable thing", "paper", "webpage", "website", "leaf", "card", "ticket"], ["flat", "flexible", "paper", "cardboard", "pertaining to the web"], ["paper over", "wrap", "shred"]], 
				["loje",	 1, ["color red", "red thing"], ["red"], ["color red"]], 
				["lon",	 	 5, ["location", "address", "situation", "reality", "truth", "existence"], ["real", "true", "existing", "correct", "present (being)", "awake"], ["place in/at/on", "bring to", "correct", "verify", "bring into existence", "create", "awaken"], ["exist", "be true"], [], ["at", "in", "on"]], 
				["luka",	 0, ["arm", "foreleg", "wing", "hand"], ["pertaining to arm", "pertaining to hand", "wing"], ["embrace", "shake hands with", "greet", "massage", "touch", "feel"], [], [], [], [], [], [], ["five"]], 
				["lukin",	 3, ["vision", "sight", "attention", "eye"], ["visual", "alert", "attentive"], ["look at", "see", "watch", "be aware of", "attend to", "care for", "show", "seek", "look for"], ["look", "see", "watch", "be aware"], ["obviously", "clearly", "apparently"], [], [], ["try", "work at"]], 
				["lupa",	 0, ["hole", "orifice", "window", "door", "goal"], ["hollow", "spongy", "worm-eaten"], ["bore", "dig into"], ["burrow"]], 
				["ma",	 	 0, ["land", "ground", "dirt", "soil", "earth", "real property", "country", "nation", "region", "Earth", "outdoors", "place"], ["dirty", "grimy", "soiled", "pertaining to soil", "national", "regional", "territorial", "terrestrial"], ["dirty", "soil", "found nation"]], 
				["mama",	 0, ["parent", "mother", "father", "creator", "caretaker", "sustainer", "ancestor", "originator"], ["parental", "maternal", "paternal", "motherly", "fatherly"], ["parent", "raise", "care for"]], 
				["mani",	 0, ["money", "wealth", "currency", "capital", "flocks", "herd animals"], ["monetary", "financial", "herdlike", "docile"], ["give money to", "pay", "make money from", "exploit", "domesticate"]], 
				["meli",	 0, ["female", "woman", "wife", "girl", "girlfriend"], ["female", "feminine", "womanly"], ["pander for", "feminise", "castrate"]], 
				["mi",		 0, ["me", "we", "us", "I"], ["my", "mine", "our", "ours"], ["claim", "appropriate"], [], ["in my opinion", "from my point of view", "personally"]], 
				["mije",	 0, ["male", "man", "husband", "boy", "boyfriend"], ["male", "manly", "masculine"], ["masculinise"]], 
				["moku",	 3, ["food", "meal", "drink"], ["eating", "edible", "food"], ["eat"], ["eat"]], 
				["moli",	 1, ["death", "dead being"], ["dead", "lethal", "fatal", "deadly"], ["kill", "murder", "execute"], ["die"]], 
				["monsi",	 0, ["back", "backside", "rear", "butt", "ass", "bottom", "buttox"], ["rear", "behind", "in back"], ["moon"]], 
				["monsuta",	 2, ["monster", "bogeyman", "fear", "fright", "terror"], ["fearful", "afraid", "frightened", "frightening"], ["fear", "be frightened by", "frighten"]], 
				["mu",		 8, ["animal noise"], ["making an animal noise"], ["making an animal noise to convey", "talking nonsense in saying", "say the lie of"], ["make an animal noise"], [], [], [], [], ["{animal noise}", "moo", "meow", "cawcaw", "buckbuck", "baa", "squawk", "woof", "tweet"]], 
				["mun",		 0, ["moon", "planet", "star", "sattelite", "light in sky"], ["lunar", "stellar", "extraterrestrial"], ["launch into space"]], 
				["musi",	 0, ["play", "game", "recreation", "entertainment", "fun", "art"], ["amusing", "entertaining", "recreational", "fun", "artful", "artistic", "musical", "frivolous", "playful"], ["entertain", "amuse", "play with"], ["have fun", "play", "exercise"]], 
				["mute",	 1, ["a lot", "multitiude", "quanitty", "a lot"], ["much", "several", "many", "numerous"], ["increase", "multiple", "augment", "nourish", "improve"], [], [], [], [], [], [], ["20"]], 
				["namako",	 0, ["seasoning", "accessory", "lagniappe", "trimming", "something good added on top"], ["accessory", "spicy"], ["excite", "stimulate", "decorate"], ["decorate"]], 
				["nanpa",	 0, ["number", "ordinal"], ["numeral", "numeric", "dealthing with numbers"], ["enumerate", "count"]], 
				["nasa",	 1, ["strangeness", "stupidity", "drunkenness"], ["crazy", "unusual", "abnormal", "strange", "foolish", "stupid", "silly", "weird", "drunken", "unconventional"], ["confuse", "scramble", "get drunk"], ["act strangely"]], 
				["nasin",	 0, ["way", "system", "custom", "road", "path", "street", "program", "doctrine", "course of action", "method", "habit", "manner"], ["systematic", "habitual", "customary", "doctinal", "doctrinaire", "pertaining to roads"], ["clear a path through", "indoctrinate", "enculturate", "plan", "plot", "program", "adopt (way of life)", "follow (plan)"]], 
				["nena",	 0, ["bump", "protudence", "hill", "mountain", "nose", "breast", "button"], ["button", "hilly", "pertaining to nose", "pertaining to breasts", "pertaining to a protudence", "similar to a protudence"], ["make bumpy, roughen, impusse, rub, sand, sting, inoculate"]], 
				["ni",		 0, ["this", "that", "yonder"], ["this", "that"], [], [], [], [], ["{refers to subordinate clause}"]], 
				["nimi",	 0, ["word", "name", "phrase"], ["verbal", "nominal"], ["name", "call"]], 
				["noka",	 0, ["leg", "foot", "hindleg"], ["pertaining to legs", "pertaining to feet", "lower", "bottom"], ["kick"]], 
				["o",		 7, [], [], [], [], [], [], ["{marks optative}"], ["{marks imperative}", "{marks vocative}"]], 
				["oko",		 0, ["eye", "optical", "pertaining to eyes"], [], ["look at", "see"]], 
				["olin",	 2, ["love", "beloved"], ["loved", "loving", "in love"], ["love", "respect", "have compassion for", "show affection to"], ["love"]], 
				["ona",		 0, ["it", "they", "she", "he"], ["theirs", "its", "hers", "his"], [], [], ["they (must specific) say"]], 
				["open",	 1, ["start", "beginning", "opening"], ["open", "initial", "starting", "opening"], ["open", "turn on", "start up"], ["open", "start", "begin"], ["firstly", "to begin with", "in the beginning"]], 
				["pakala",	 2, ["destruction", "ruin", "disaster", "damage", "pain", "error", "mistake", "screw-up"], ["desrtructive", "ruinous", "destroyed", "ruined", "broken", "botched", "erroneous", "mistaken"], ["harm", "damage", "destroy", "break", "ruin", "spoil", "hurt", "injure", "err", "botch", "mess up", "screw up", "fuck up", "make a mistake", "fail at"], [], [], [], [], [], ["{cuss of frustration}", "damn!", "shit!", "fuck!"]], 
				["pali",	 2, ["act", "action", "deed", "activity", "function", "cultivation", "work", "project", "job", "trade", "career", "profession"], ["active", "creative", "working", "functioning", "caring", "busy", "habitual"], ["make", "work", "build", "care for", "cultivate", "prepare", "do"], ["make", "work"], [], [], [], ["in the habit of", "accustomed to"]], 
				["palisa",	 0, ["rod", "long thin hard thing", "stick", "branch", "phallus", "dildo"], ["long and thin", "tall and thin"], ["stretch", "beat", "sexually arouse"]], 
				["pan",		 0, ["bread", "grain", "flour", "baked good"], ["baked", "made of bread", "containing grain", "floury"], ["bake", "coat with flour", "mill", "grind"], ["bake"]], 
				["pana",	 2, ["giving", "sending", "release", "transmission", "gift", "messenger", "representative", "ambassador", "donation", "radiation"], ["generous", "radioactive"], ["emit", "give", "send", "release", "transfer", "transmit", "cause", "place", "exchange", "sell", "shoot", "put"]], 
				["pi",		 6, [], [], [], [], [], [], ["of", "{introduces a right grouped unit within a noun phrase}", "{introduces prepositional phrase modifying a noun phrase}"]], 
				["pilin",	 3, ["thought", "emotion", "texture", "opinion"], ["thoughtful", "emotional", "tactile"], ["feel (thing)", "touch", "caress", "fondle", "think", "opine"], ["feel (emotion)", "think"]], 
				["pimeja",	 1, ["darkness", "shadow", "blackness"], ["dark", "black"], ["darken", "blacken"], ["darken", "blacken"]], 
				["pini",	 3, ["end", "tip", "point", "completion"], ["done", "finished", "completed", "ended", "closed", "past", "ago"], ["end", "finish", "close", "turn off", "extinguish"], ["end", "finish", "close", "turn off", "extinguish"]], 
				["pipi",	 0, ["bug", "invertebrate", "insect", "spider"], ["bug", "insect", "invertebrate", "spider", "annoying"], ["expose to bugs", "annoy"]], 
				["poka",	 0, ["side", "hips", "ribs", "proximity", "partisanship"], ["near", "next to", "neighboring", "almost", "more than", "partisan", "beside"], ["approach", "draw in", "win over", "convert"], ["convert"], [], ["with", "accompanying"]], 
				["poki",	 0, ["container", "box", "bag", "bowl", "cup", "can", "storage"], ["stored", "canned", "packaged", "in a container", "pertaining to a container", "restricted", "limited", "confined", "secure"], ["can", "put into a container", "store", "pack"], ["be canned", "be put into a container", "be stored", "be packed"]], 
				["pona",	 1, ["ease", "simplicity", "health", "calmness", "positivity", "value"], ["good", "easy", "simple", "healthy", "positive", "nice", "calm", "peaceful"], ["make good", "improve", "cure", "fix", "simplify", "quiet", "clean", "evaluate"], ["be good", "be simple", "improve", "simplify", "evaluate"], ["fortunately", "happily"], ["good!", "great!", "cool!", "yay!", "thank you", "thanks"]], 
				["pu",		 0, ["the official toki pona book"], ["relating to the official toki pona book"], [], ["interacting with the official toki pona book"]], 
				["sama",	 5, ["identity", "similarity", "-self (reflexive)", "one another (reciprocal)"], ["like", "similar to", "same as", "close kin to", "equal"], ["make equal", "balance", "reconcile", "compare"], [], ["similarly", "in the same way"], ["same", "same as", "like", "indetical to"]], 
				["seli",	 0, ["heat", "fire", "warmth", "heat source", "chemical reaction"], ["hot", "fiery", "cooked", "burnt", "intense", "eager", "excited"], ["cook", "warm up", "burn", "stir up", "excite"]], 
				["selo",	 0, ["skin", "hide", "bark", "shell", "rind", "peel", "cell wall", "outside", "shape", "surface", "outer form", "boundary"], ["dermal", "superficial", "surface", "leathery", "external", "safe", "protected"], ["touch", "shape"]], 
				["seme",	 0, ["what?", "who?", "which?"], ["which?", "what sort of?"], ["does what to?"], ["is what?", "does what?"]], 
				["sewi",	 1, ["top", "overhead", "height", "highest part", "sky", "god"], ["high", "overhead", "elevated", "top", "superior", "formal", "religious", "worshipped", "sacred", "supernatural", "divine"], ["lift", "raise up", "worship", "adore"], ["get up", "arise", "win"], [], ["on top of", "over", "on", "above"]], 
				["sijelo",	 0, ["body", "physical state", "torso"], ["physical", "bodily"], ["incarnate", "lean on", "fall on top of"]], 
				["sike",	 1, ["circle", "ball", "wheel", "cycle"], ["round", "circular", "spherical", "cyclical", "of one year"], ["encircle", "surround", "form into a circle", "revolve around", "rotate around", "cycle through"]], 
				["sin",		 1, ["more", "another", "news"], ["new", "fresh", "young", "anew", "once again", "additional"], ["renew renovate"]], 
				["sina",	 0, ["you", "you (plural)"], ["your", "yours"]], 
				["sinpin",	 0, ["front", "face", "chest", "torso", "wall", "vertical surface"], ["front", "facial", "torsal", "pectoral", "vertical", "foremost"], ["build a wall out of", "drop a wall on", "set upright"], [], [], ["in front of", "before (not temporal)"]], 
				["sitelen",	 2, ["writings", "drawings", "pictures", "phtoographs", "representation", "image", "character", "letter", "writing", "drawing", "photography", "filming", "typing"], ["written", "drawn", "carved", "photographed", "filmed", "typed", "representational"], ["draw", "write", "carve", "photograph", "film", "type"], ["draw", "write", "carve", "photograph", "film", "type"], ["literally", "according to authoritative records"]], 
				["sona",	 2, ["knowledge", "science", "philosophy", "a system of beliefs", "wisdom", "plan", "aphorism", "wise advice"], ["wise", "intelligent", "learned"], ["know", "know how to", "plan", "understand", "mean"], ["know", "understand", "plan"], [], [], [], ["know how to"]], 
				["soweli",	 0, ["beast", "land mammal", "animalia", "cute cuddly animal"], ["animal", "cute and cuddly"]], 
				["suli",	 1, ["size", "dimension", "importance"], ["big", "tall", "fat", "long", "wide", "deep", "large", "heavy", "adult", "mature", "ripe", "important", "significant", "influential"], ["enlarge", "cultivate", "promote"]], 
				["suno",	 0, ["sun", "day", "daytime", "brightness", "glow", "radiance", "light source"], ["bright", "lit", "light"], ["light", "illumine"]], 
				["supa",	 0, ["surface", "furniture", "floor", "table", "chair", "bed", "pillow", "plane", "place to put or rest things on"], ["flat", "horizontal"], ["flatten", "plane", "smooth"]], 
				["suwi",	 1, ["sugar", "sweetener", "candy", "other confectionaries"], ["sweet", "pleasent", "cute", "adorable", "fragrant"]], 
				["tan",		 5, ["origin", "source", "cause", "reason", "motive"], ["causal", "motivational"], ["fetch", "take", "rescue"], [], [], ["from"]], 
				["taso",	 1, ["hermit", "recluse", "exception"], ["only", "exactly", "sole", "alone", "exceptional"], ["isolate", "abandon", "cut off", "ban", "make an exception of"], [], [], ["except"], ["but", "except of"]], 
				["tawa",	 5, ["destination", "target", "goal", "purpose", "movement", "transportation", "travel", "transportation", "conduct", "experience"], ["moving", "mobile"], ["move", "send"], ["move", "leave", "go to"], [], ["toward", "to", "in the direction of", "for", "until", "in order to", "from the perspective of"]], 
				["telo",	 0, ["water", "liquid", "soup", "sauce", "juice", "gasoline", "coffee"], ["liquid", "flowing", "wet", "washed"], ["water", "wash", "moisten", "melt"]], 
				["tenpo",	 0, ["time", "moment", "duration", "generation", "situation", "ocasion", "period"], ["temporal"], ["time", "take time"]], 
				["toki",	 3, ["talk", "speech", "message", "language", "communication", "information"], ["talking", "verbal", "linguistic", "informative"], ["say", "use language", "think", "talk", "communicate"], ["communicate", "talk", "use language", "think", "inform"], [], [], [], [], ["hello", "hi", "greetings"]], 
				["tu",		 9, ["pair", "duo"], [], ["double", "divide", "seperate", "split", "cut in two"], [], [], [], [], [], [], ["2"]], 
				["unpa",	 2, ["sex act", "sexuality"], ["sexual", "erotic"], ["have sex with", "copulate", "pollinate", "fertilise", "sodomise", "be married to"], ["sex", "masturbate"]], 
				["uta",		 0, ["mouth", "lips", "jaw", "oral cavity"], ["oral"], ["kiss", "suck"]], 
				["utala",	 0, ["conflict", "fight", "battle", "war", "violence", "attack", "blow", "argument"], ["violent", "military", "argumenttive"], ["fight", "attack", "strike", "hit", "argue", "compete", "challenge", "compete against", "struggle against"]], 
				["walo",	 1, ["whiteness", "lightness"], ["white", "pale"], ["paint white", "whitewash"]], 
				["wan",		 9, ["unit", "element", "particle", "part", "piece"], ["unit", "whole", "alone", "lonesome", "unique", "united"], ["unite", "join together", "make one", "marry", "isolate"], ["marry"], [], [], [], [], [], ["1"]], 
				["waso",	 0, ["bird", "flying animal", "bat", "pterodactyl", "fly"], ["avian"], ["fly"], ["fly"]], 
				["wawa",	 1, ["power", "strength", "speed", "confidence", "energy"], ["power", "powerful", "strong", "energetic", "intense", "fierce", "sure", "confident", "fast"], ["empower", "boost", "strengthen", "speed up"]], 
				["weka",	 1, ["absence", "distance", "refuse", "trash"], ["away", "absent", "missing", "far", "ignored"], ["throw away", "get rid of", "remove", "extricate", "rescue", "save"], [], [], ["except"]], 
				["wile",	 7, ["need", "want", "desire", "obligation", "duty", "will"], [], [], [], [], [], [], ["want", "need to", "have to", "must", "ought", "should", "wants", "desires", "is required to"]]]
			.map(nimi=>{
			// converting array to object
			let obj = {}

			// loop over all the potential properties
			for (i=0; i<mapping.length; i++) {
					obj[mapping[i]] = nimi[i]	// set object's corresponding property to array's index
									||[]		// if undefined default to empty array
				}

				// convert the property 'main', stored as the index-2 in mapping of the word's main linguistic feature
				obj.main = [mapping[obj.main+2],	// the feature name  
							nimi[obj.main+2][0]]	// the relevant definition
				return obj
			})
		</script>
		<script>
			const words = pu.map(x=>x.text)
							.sort((a,b)=>b.length-a.length) // longest words first so we can properly match 

			// put a random word in the textbox for fun and to show its typable
			var main = document.getElementById("main")
			main.innerText = words[Math.floor(Math.random()*words.length)]

//			pu.map(niwi=>Object.keys(initial).map(deftype=>niwi[deftype]=niwi[deftype].map(def=>def.replace(/ /g, "&nbsp;")))) // replace spaces in definitions with non-breaking spaces so it doesnt split into multi lines

			var supa_pu = pu.map(nimi=>
				[[nimi.text, nimi.main[1]],  ...Object.keys(initial)]
				.reduce((curr, next)=>curr.concat([nimi[next]])))

			function searchPu(text) {
				return [
					searchNimi(text),
					strictSearchPu(text),
					supa_pu.map(nimi=>[nimi, nimi.toString().indexOf(text)])
					 		  .filter(li=>li[1]!==-1)
							  .sort((a,b)=>a[1]-b[1])
							  .map(li=>li[0][0])
					].reduce((next, unique)=>unique.includes(next[0])?unique:unique.concat(next))
				}

			function strictSearchPu(text) {
				var regex = new RegExp("\\W"+text+"\\W")
				return supa_pu.map(nimi=>[nimi, nimi.toString().match(regex)])
					 		  .filter(li=>li[1]!==null)
							  .sort((a,b)=>a[1].index-b[1].index)
							  .map(li=>li[0][0])	
			}

			function searchNimi(text) {
				return words.filter(nimi=>nimi.includes(text))
			}

			function define(niwi) {
				return pu.filter(li=>li.text===niwi)[0]
			}

			function logDefinition(niwi) {
				let output = ["Name: "+niwi.text]
				output.push(`${initial[niwi.main[0]]} ${niwi.main[1]}`)
				let things = Object.keys(initial)
				things.map(type=>{
						if(niwi[type].length) 
							output.push(type+": "+niwi[type].join(", "))
					})
				return output
			}

			function showDefinition(niwi, searchstring) {
				niwi = define(niwi)
				let output = [`<strong class="minidef"><tokipona>${niwi.text}</tokipona> ${niwi.text} <definition>${niwi.main[1]}</definition></strong><ul>`]
				
				things = Object.keys(initial)
				things.map(type=>{ if(niwi[type].length) {
					output.push("<definitiontype>"+initial[type]+"</definitiontype><definition><span>"+niwi[type].join("</span>, <span>")+"</span></definition>")
				}})

				var display = document.createElement("div")
				display.className = "fullDefinition"
				display.innerHTML = output.join("</li><li>")+"</li>"
				autosuggest.append(display)
				return display
			}

			function genMiniDefinition (niwi, searchstring) {
				niwi = define(niwi)
				if (niwi===undefined) return ""

				var display = document.createElement("li")
				display.className="minidef"
				
				if (searchstring&&!niwi.text.includes(searchstring)) {
					let firstMatch = Object.keys(initial).map(
						deftype=>niwi[deftype].map(x=>[x.includes(searchstring), x, deftype]).filter(x=>x[0])[0])
					.filter(x=>x)[0]
					display.innerHTML=`<a class="searchterm">${searchstring}</a><tokipona>${niwi.text}</tokipona> ${niwi.text} <definition>${firstMatch[1].replace(searchstring, "<b>"+searchstring+"</b>")} (${initial[firstMatch[2]][0]})</definition>`
				} else {
					display.innerHTML=`<a class="searchterm">${searchstring}</a><tokipona>${niwi.text}</tokipona> ${niwi.text} <definition>${niwi.main[1]}</definition>`
				}
				return display
			}

			function searchAndMini(searchstring) {
				var results = searchPu(searchstring)
				if (results.length) results.map(nimi=>autosuggest.append(genMiniDefinition(nimi, searchstring)))
				else {
					searchstring =	searchstring
					//							.replace(new RegExp("^("+words.join("|")+")+(?=.)"), "") // removes valid words as long as there is at least one character after. 
					// above line worked for "mimute"->"mute" & "mimutel"->"l" but incorrectly did "mimuteen"->"n" / "mialasa"->"sa"
												.replace(new RegExp(words.join("|"), "g"), "{{$&}}") // this time we make the toki pona words seperated so it cant match partial of one
												.replace(/^{{.+}}(?=.)/, "") // then we do the same thing, remove valid words up to a point where there's at least one more valid character
												.replace(/{|}/g, "") // then we get rid of any remaining tag seperators
					var results = searchPu(searchstring)
					if (words.includes(searchstring)) showDefinition(searchstring)
					else if (results.length) results.map(nimi=>autosuggest.append(genMiniDefinition(nimi, searchstring)))
					else autosuggest.hidden="true"
				}
			}

			var selection
			function showSuggestion () {
				selection = window.getSelection()
				var node = selection.anchorNode

				//if (node.parentElement.id !== "main") return selectNone() // only continue if selecting right place 

				if (selection.type==="Caret") {

					if (!node.wholeText) return selectNone()

					let selectedWord = node.wholeText
										.slice(0, selection.anchorOffset)
										.split(/[^a-z]/)
										.slice(-1)[0]

					if (!selectedWord) return selectNone()

					let range = selection.getRangeAt(0).cloneRange()
					range.setStart(node, selection.anchorOffset - selectedWord.length)
					range = range.getBoundingClientRect()

					autosuggest.hidden=false
					autosuggest.style.left=range.left 
					autosuggest.style.top=range.bottom
					autosuggest.innerHTML=""

					if (words.includes(selectedWord)) showDefinition(selectedWord)
					else searchAndMini(selectedWord)

					hl.style.left=range.left 
					hl.style.top=range.top
					hl.style.width=range.width
					hl.style.height=range.height

				} else if (selection.type === "Range") {
					range = selection.getRangeAt(0)

					autosuggest.hidden=false
					autosuggest.style.left=range.left 
					autosuggest.style.top=range.bottom
					autosuggest.style.width=Math.max(range.getBoundingClientRect().width, 500)
					autosuggest.innerHTML=""

					hl.style.left=range.left 
					hl.style.top=range.top
					hl.style.width=range.width
					hl.style.height=range.height


					let valid = range.toString().match(new RegExp(words.join("|"), "g"))
					if (valid) valid.map(x=>showDefinition(x))
				}
			}
			var range
			function selectNone() {
				autosuggest.hidden=true
			}


			var autosuggest = document.createElement("div")
			autosuggest.className = "suggestions"
			autosuggest.hidden = "true"
			autosuggest.style.opacity="70%"
			autosuggest.onmousedown = suggestionClicked
			document.body.append(autosuggest)

			var hl = document.createElement("div")
			hl.style.position = "absolute"
			hl.style.zIndex = 100
			hl.style.backgroundColor = "#cc0"
			hl.style.opacity = "50%"
			hl.hidden = true
			document.body.append(hl)

			document.onselectionchange = showSuggestion
			
			main.onkeyup=(e)=>{
				if(e.key==="Backspace") showSuggestion() // selectionchange doesnt trigger on backspace for some reason
			} 
			function suggestionClicked(e){
				e.preventDefault()
				var x = e.toElement
				host = x
				var cacheSelection = selection.getRangeAt(0)

				if (host.nodeName==="STRONG") { host = host.parentNode }
				if (host.nodeName==="SPAN") { host = host.parentNode }
				if (host.nodeName==="TOKIPONA") { host = host.parentNode }
				if (host.nodeName==="DEFINITION"||host.nodeName==="DEFINITIONTYPE") { host = host.parentNode }
				if (host.nodeName==="STRONG") { host = host.parentNode }
				if (host.className==="minidef") { 
//					showDefinition(host.children[0].innerText)
					host.value
					let node = selection.baseNode
					let selectlength = host.children[0].outerText.length
					let word = host.children[1].innerText

					pos = Math.max(selection.anchorOffset, selection.baseOffset)
					node.textContent=node.textContent.slice(0, pos-selectlength) + word + node.textContent.slice(pos)

					autosuggest.innerHTML=""
					showDefinition(word)
				} else if (host.nodeName==="LI") { host = host.parentNode }
				if (host.nodeName==="UL") { host.style.display = "none" }
				
				if (host.className==="fullDefinition") {
					let ul = host.children[1]
					if (ul.style.display === "none") ul.style.display = "block"
					else ul.style.display = "none"
				}
			}
		</script>

</body></html>